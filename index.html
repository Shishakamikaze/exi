html_content = """
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exfill - Battle Royale</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #181818;
      color: #fff;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    .arena {
      position: relative;
      width: 600px;
      height: 400px;
      border: 2px solid #fff;
      background-color: #2c3e50;
      overflow: hidden;
      margin: 20px;
    }
    .player {
      width: 30px;
      height: 30px;
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      color: #fff;
    }
    .strichmann {
      width: 10px;
      height: 20px;
      background-color: transparent;
      position: relative;
      border: 2px solid;
      border-radius: 50%;
      border-top-color: inherit;
      border-right-color: transparent;
      border-bottom-color: inherit;
      border-left-color: transparent;
    }
    .winner-message {
      font-size: 1.5rem;
      margin-top: 20px;
      color: #2ecc71;
    }
    .join-message {
      font-size: 1rem;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h1>Exfill - Battle Royale</h1>
  <div class="join-message">Schreibe <code>!join</code> im Chat, um f√ºr 50 Kanalpunkte teilzunehmen!</div>
  <div class="arena" id="arena"></div>
  <div class="winner-message" id="winnerMessage"></div>

  <script src="https://cdn.jsdelivr.net/npm/tmi.js"></script>
  <script>
    const client = new tmi.Client({
      options: { debug: true },
      connection: {
        reconnect: true,
        secure: true
      },
      channels: ['Shishakamikaze']
    });

    client.connect();

    const arena = document.getElementById('arena');
    const winnerMessage = document.getElementById('winnerMessage');

    let gameStarted = false;
    let joinPhaseActive = false;
    let players = [];
    let playerElements = [];

    client.on('message', (channel, tags, message, self) => {
      if (self) return;

      const username = tags.username;

      // Start command
      if (message.trim().toLowerCase() === '!exfill' && !gameStarted) {
        gameStarted = true;
        joinPhaseActive = true;
        players = []; // Reset players
        winnerMessage.textContent = '';
        client.say('Shishakamikaze', 'Das Spiel hat begonnen! Ihr habt 30 Sekunden, um mit "!join" beizutreten (50 Kanalpunkte).');

        setTimeout(() => {
          joinPhaseActive = false;
          client.say('Shishakamikaze', 'Die Beitrittsphase ist beendet. Das Spiel beginnt jetzt!');
          startBattle();
        }, 30000); // 30 seconds join phase
      }

      // Join command
      if (message.trim().toLowerCase() === '!join' && joinPhaseActive) {
        if (!players.some(player => player.username === username)) {
          players.push({ username, pointsPaid: 50 });
          console.log(`${username} hat 50 Kanalpunkte bezahlt und ist dem Spiel beigetreten.`);
          client.say('Shishakamikaze', `${username} ist dem Spiel beigetreten!`);
        }
      }
    });

    function createPlayerElement(username, color) {
      const playerDiv = document.createElement('div');
      playerDiv.classList.add('player');
      playerDiv.style.backgroundColor = color;

      const strichmann = document.createElement('div');
      strichmann.classList.add('strichmann');
      strichmann.style.borderTopColor = color;
      strichmann.style.borderBottomColor = color;

      playerDiv.appendChild(strichmann);
      playerDiv.style.left = `${Math.random() * (arena.offsetWidth - 30)}px`;
      playerDiv.style.top = `${Math.random() * (arena.offsetHeight - 30)}px`;
      playerDiv.dataset.username = username;
      arena.appendChild(playerDiv);
      return playerDiv;
    }

    function startBattle() {
      if (players.length === 0) {
        client.say('Shishakamikaze', 'Keine Spieler haben sich dem Spiel angeschlossen!');
        gameStarted = false;
        return;
      }

      playerElements = [];

      players.forEach(player => {
        const color = `hsl(${Math.random() * 360}, 70%, 50%)`;
        const playerElement = createPlayerElement(player.username, color);
        playerElements.push(playerElement);
      });

      simulateBattle();
    }

    function simulateBattle() {
      const startTime = Date.now();
      const gameDuration = 60000; // 1 minute in milliseconds

      const interval = setInterval(() => {
        const elapsedTime = Date.now() - startTime;

        if (elapsedTime >= gameDuration || playerElements.length <= 1) {
          clearInterval(interval);

          if (playerElements.length === 1) {
            const winner = playerElements[0].dataset.username;
            winnerMessage.textContent = `${winner} hat gewonnen und erh√§lt 500 Kanalpunkte! üéâ`;
            client.say('Shishakamikaze', `${winner} hat das Spiel gewonnen und erh√§lt 500 Kanalpunkte! üéâ`);
          } else {
            winnerMessage.textContent = 'Kein Gewinner - alle sind tot!';
          }

          gameStarted = false;
        } else {
          if (Math.random() < 0.5) {
            const action = Math.random();

            if (action < 0.5 && playerElements.length > 1) {
              // Eliminierung
              const randomIndex = Math.floor(Math.random() * playerElements.length);
              const eliminated = playerElements.splice(randomIndex, 1)[0];
              eliminated.remove();
            } else if (action >= 0.5 && playerElements.length > 1) {
              // Exfiltration
              const randomIndex = Math.floor(Math.random() * playerElements.length);
              const exfiltrated = playerElements.splice(randomIndex, 1)[0];
              exfiltrated.remove();
            }
          }
        }
      }, 1000);
    }

    document.addEventListener('keydown', (event) => {
      if (event.key === 'Enter' && gameStarted) {
        startBattle();
      }
    });
  </script>
</body>
</html>
"""

with open(os.path.join(project_dir, "index.html"), "w") as file:
    file.write(html_content)

# Create a ZIP file
zip_path = "/mnt/data/Exfill.zip"
with zipfile.ZipFile(zip_path, "w") as zipf:
    for root, dirs, files in os.walk(project_dir):
        for file in files:
            file_path = os.path.join(root, file)
            zipf.write(file_path, os.path.relpath(file_path, project_dir))

